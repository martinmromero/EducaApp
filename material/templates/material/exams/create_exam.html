
{% extends 'material/base.html' %}
{% load static %}
{% block content %}
<script src="{% static 'material/js/create_exam.js' %}"></script>
<h2>Crear Examen</h2>
<form method="post">
    {% csrf_token %}
    {{ form.non_field_errors }}
    <button type="button" class="btn btn-secondary" onclick="location.reload();">Limpiar datos</button>
    <button type="submit" name="preview" value="1" class="btn btn-info ms-2">Vista previa</button>

    <!-- Sección 2 columnas: Plantilla - Materia -->
    <div class="row mb-3">
        <div class="col-md-6">
            <label for="plantilla">Plantilla</label>
            <select class="form-select" name="plantilla" id="plantilla">
                <option value="">Examen vacío</option>
                {% for template in templates %}
                    <option value="{{ template.id }}">{{ template }}</option>
                {% endfor %}
            </select>
        </div>
        <div class="col-md-6">
            {{ form.subject.label_tag }}
            {{ form.subject }}
        </div>
    </div>

    <!-- Sección 1 columna: Resultados de aprendizaje -->
    <div class="mb-3">
        <label for="id_learning_outcomes">Resultados de aprendizaje</label>
        <div id="learning_outcomes_container">
            <!-- Los checkboxes se poblarán dinámicamente -->
        </div>
    </div>

    <!-- Sección 3 columnas: Institución - Facultad - Carrera -->
    <div class="row mb-3">
        <div class="col-md-4">
            <label for="institucion_dropdown">Institución</label>
            <select class="form-select" name="institucion_dropdown" id="institucion_dropdown" onchange="toggleTextbox('institucion_dropdown', 'institucion_text')">
                <option value="">Seleccionar institución</option>
                {% for institucion in instituciones %}
                    <option value="{{ institucion.id }}">{{ institucion.name }}</option>
                {% endfor %}
                <option value="otro">Otro</option>
            </select>
            <input type="text" class="form-control mt-2" name="institucion_text" id="institucion_text" placeholder="Ingrese institución" style="display:none;">
        </div>
        <div class="col-md-4">
            <label for="facultad_dropdown">Facultad</label>
            <select class="form-select" name="facultad_dropdown" id="facultad_dropdown" onchange="toggleTextbox('facultad_dropdown', 'facultad_text')">
                <option value="">Seleccionar facultad</option>
                <option value="otro">Otro</option>
            </select>
            <input type="text" class="form-control mt-2" name="facultad_text" id="facultad_text" placeholder="Ingrese facultad" style="display:none;">
        </div>
        <div class="col-md-4">
            <label for="carrera_dropdown">Carrera</label>
            <select class="form-select" name="carrera_dropdown" id="carrera_dropdown" onchange="toggleTextbox('carrera_dropdown', 'carrera_text')">
                <option value="">Seleccionar carrera</option>
                {% for carrera in carreras %}
                    <option value="{{ carrera.id }}">{{ carrera.name }}</option>
                {% endfor %}
                <option value="otro">Otro</option>
            </select>
            <input type="text" class="form-control mt-2" name="carrera_text" id="carrera_text" placeholder="Ingrese carrera" style="display:none;">
        </div>
    </div>

    <!-- Sección 3 columnas: Sede / Localización - Curso / Comisión - Turno -->
    <div class="row mb-3">
        <div class="col-md-4">
            <label for="sede_dropdown">Sede / Localización</label>
            <select class="form-select" name="sede_dropdown" id="sede_dropdown" onchange="toggleTextbox('sede_dropdown', 'sede_text')">
                <option value="">Seleccionar sede</option>
                <option value="otro">Otro</option>
            </select>
            <input type="text" class="form-control mt-2" name="sede_text" id="sede_text" placeholder="Ingrese sede" style="display:none;">
        </div>
        <div class="col-md-4">
            <label for="curso">Curso / Comisión </label>
            <input type="text" class="form-control" name="curso" id="curso">
        </div>
        <div class="col-md-4">
            <label for="turno_dropdown">Turno</label>
            <select class="form-select" name="turno_dropdown" id="turno_dropdown" onchange="toggleTextbox('turno_dropdown', 'turno_text')">
                <option value="">Seleccionar turno</option>
                <option value="Mañana">Mañana</option>
                <option value="Tarde">Tarde</option>
                <option value="Noche">Noche</option>
                <option value="otro">Otro</option>
            </select>
            <input type="text" class="form-control mt-2" name="turno_text" id="turno_text" placeholder="Ingrese turno" style="display:none;">
        </div>
    </div>

    <!-- Sección 3 columnas: Profesor - Fecha - Duración (minutos) -->
    <div class="row mb-3">
        <div class="col-md-4">
            <label for="profesor_dropdown">Profesor</label>
            <select class="form-select" name="profesor_dropdown" id="profesor_dropdown" onchange="toggleTextbox('profesor_dropdown', 'profesor_text')">
                <option value="">Seleccionar profesor</option>
                {% for profesor in profesores %}
                    <option value="{{ profesor.id }}">{{ profesor.get_full_name }}</option>
                {% endfor %}
                <option value="otro">Otro</option>
            </select>
            <input type="text" class="form-control mt-2" name="profesor_text" id="profesor_text" placeholder="Ingrese profesor" style="display:none;">
        </div>
        <div class="col-md-4">
            <label for="fecha">Fecha</label>
            <input type="date" class="form-control" name="fecha" id="fecha">
        </div>
        <div class="col-md-4">
            {{ form.duration_minutes.label_tag }}
            {{ form.duration_minutes }}
        </div>
    </div>

    <!-- Sección 3 espacios: Tipo de examen (radio), Modalidad (radio), Modalidad de resolución (checkboxes) -->
    <div class="row mb-3">
        <div class="col-md-4">
            <label>Tipo de examen</label>
            <div>
                <div class="form-check">
                    <input class="form-check-input" type="radio" name="tipo_examen" id="tipo_examen_1er" value="1er_parcial">
                    <label class="form-check-label" for="tipo_examen_1er">1er. Parcial</label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="radio" name="tipo_examen" id="tipo_examen_2do" value="2do_parcial">
                    <label class="form-check-label" for="tipo_examen_2do">2do. Parcial</label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="radio" name="tipo_examen" id="tipo_examen_3er" value="3er_parcial">
                    <label class="form-check-label" for="tipo_examen_3er">3er. Parcial</label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="radio" name="tipo_examen" id="tipo_examen_final" value="final">
                    <label class="form-check-label" for="tipo_examen_final">Final</label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="radio" name="tipo_examen" id="tipo_examen_recup" value="recuperatorio">
                    <label class="form-check-label" for="tipo_examen_recup">Recuperatorio</label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="radio" name="tipo_examen" id="tipo_examen_practico" value="practico">
                    <label class="form-check-label" for="tipo_examen_practico">Práctico</label>
                </div>
            </div>
        </div>
        <div class="col-md-4">
            <label>Modalidad</label>
            <div>
                <div class="form-check">
                    <input class="form-check-input" type="radio" name="tipo_modalidad" id="modalidad_individual" value="individual">
                    <label class="form-check-label" for="modalidad_individual">Individual</label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="radio" name="tipo_modalidad" id="modalidad_grupal" value="grupal">
                    <label class="form-check-label" for="modalidad_grupal">Grupal</label>
                </div>
            </div>
        </div>
        <div class="col-md-4">
            <label>Modalidad de resolución</label>
            <div>
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" name="modalidad_resolucion" id="resolucion_oral" value="oral">
                    <label class="form-check-label" for="resolucion_oral">Oral</label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" name="modalidad_resolucion" id="resolucion_escrito" value="escrito">
                    <label class="form-check-label" for="resolucion_escrito">Escrito</label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" name="modalidad_resolucion" id="resolucion_presencial" value="presencial">
                    <label class="form-check-label" for="resolucion_presencial">Presencial</label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" name="modalidad_resolucion" id="resolucion_virtual" value="virtual">
                    <label class="form-check-label" for="resolucion_virtual">Virtual</label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" name="modalidad_resolucion" id="resolucion_domiciliario" value="domiciliario">
                    <label class="form-check-label" for="resolucion_domiciliario">Domiciliario</label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" name="modalidad_resolucion" id="resolucion_hibrido" value="hibrido">
                    <label class="form-check-label" for="resolucion_hibrido">Híbrido</label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" name="modalidad_resolucion" id="resolucion_otro" value="otro">
                    <label class="form-check-label" for="resolucion_otro">Otro</label>
                </div>
            </div>
        </div>
    </div>

    <!-- Sección 1 columna: Instrucciones generales, Temas evaluados, Preguntas, Título -->
    <div class="mb-3">
        {{ form.instructions.label_tag }}
        {{ form.instructions }}
    </div>
    <div class="mb-3">
        <label for="id_topics">Temas evaluados</label>
        <select multiple class="form-select" name="topics" id="id_topics">
            <option value="all">Todos los temas</option>
        </select>
    </div>
    <div class="mb-3">
        {{ form.questions.label_tag }}
        {{ form.questions }}
    </div>
    <div class="mb-3" style="display:none;">
    <label for="id_title">Título</label>
    <input type="text" class="form-control" name="title" id="id_title" maxlength="255" style="display:none;">
    </div>

    <!-- Campo Alumno/a oculto -->
    <div class="mb-3" style="display:none;">
        <label for="alumno">Alumno/a</label>
        <input type="text" class="form-control" name="alumno" id="alumno" placeholder="Completar en papel" disabled>
    </div>

    <button type="submit" name="preview" value="1" class="btn btn-info me-2">Vista previa</button>
    <button type="submit" class="btn btn-primary mt-3">Crear Examen</button>
</form>
{% endblock %}