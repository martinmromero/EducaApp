{% extends 'material/base.html' %}
{% load static %}
{% load message_tags %}

{% block content %}
<div class="container-fluid">
    <h1 class="h3 mb-4 text-gray-800">Mis Cuestionarios Orales</h1>
    
    <!-- Mensajes específicos de cuestionarios orales -->
    {% show_messages "cuestionarios_orales" %}
    
    <div class="card shadow mb-4">
        <div class="card-header py-3 d-flex justify-content-between align-items-center">
            <h6 class="m-0 font-weight-bold text-primary">Listado de Cuestionarios Orales</h6>
            <a href="{% url 'material:create_oral_exam' %}" class="btn btn-primary">
                <i class="fas fa-plus"></i> Crear Cuestionario Oral
            </a>
        </div>
        <div class="card-body">
            {% if oral_exams %}
                <div class="table-responsive">
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th>Nombre</th>
                                <th>Materia</th>
                                <th>Grupos</th>
                                <th>Est. por Grupo</th>
                                <th>Preg. por Est.</th>
                                <th>Total Estudiantes</th>
                                <th>Creado</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for exam in oral_exams %}
                            <tr>
                                <td>{{ exam.name }}</td>
                                <td>{{ exam.subject.name }}</td>
                                <td>{{ exam.num_groups }}</td>
                                <td>{{ exam.students_per_group }}</td>
                                <td>{{ exam.questions_per_student }}</td>
                                <td>{{ exam.total_students }}</td>
                                <td>{{ exam.created_at|date:"d/m/Y" }}</td>
                                <td>
                                    <a href="{% url 'material:view_oral_exam' exam.id %}" 
                                       class="btn btn-sm btn-primary" 
                                       title="Ver cuestionario">
                                        <i class="fas fa-eye"></i>
                                    </a>
                                    <form method="post" action="{% url 'material:delete_oral_exam' exam.id %}" 
                                          style="display: inline;" 
                                          onsubmit="return confirm('¿Estás seguro de que quieres eliminar el cuestionario &quot;{{ exam.name|escapejs }}&quot;? Esta acción no se puede deshacer.')">
                                        {% csrf_token %}
                                        <button type="submit" class="btn btn-sm btn-danger" 
                                                title="Eliminar cuestionario">
                                            <i class="fas fa-trash"></i>
                                        </button>
                                    </form>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            {% else %}
                <div class="text-center py-5">
                    <i class="fas fa-clipboard-list fa-3x text-muted mb-3"></i>
                    <h5>No tienes cuestionarios orales creados</h5>
                    <p class="text-muted">Crea tu primer cuestionario oral haciendo clic en el botón de arriba</p>
                    <a href="{% url 'material:create_oral_exam' %}" class="btn btn-primary">
                        <i class="fas fa-plus"></i> Crear Mi Primer Cuestionario
                    </a>
                </div>
            {% endif %}
        </div>
    </div>
</div>



{% endblock %}
