{% extends 'material/base.html' %}
{% load static %}

{% block content %}
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
<link rel="stylesheet" href="{% static 'material/css/create_exam_template.css' %}">

<h2>Crear Plantilla de Examen</h2>
<form method="post" enctype="multipart/form-data" id="examTemplateForm">
    {% csrf_token %}

    <div class="two-column-form">
        <!-- Columna izquierda -->
        <div class="form-column">
            <!-- Institución -->
            <div class="form-group">
                <label for="{{ form.institution.id_for_label }}">{{ form.institution.label }}</label>
                <div class="input-group">
                    {{ form.institution }}
                    <div class="input-group-append">
                        <button type="button" class="btn btn-sm btn-outline-secondary dynamic-add-btn" 
                                data-target="institution" data-field="id_institution">
                            <i class="fas fa-plus"></i> Nuevo
                        </button>
                    </div>
                </div>
                <input type="text" class="form-control dynamic-input" id="new_institution" placeholder="Nombre de la Institución">
            </div>

            <!-- Facultad -->
            <div class="form-group">
                <label for="{{ form.faculty.id_for_label }}">{{ form.faculty.label }}</label>
                <div class="input-group">
                    {{ form.faculty }}
                    <div class="input-group-append">
                        <button type="button" class="btn btn-sm btn-outline-secondary dynamic-add-btn" 
                                data-target="faculty" data-field="id_faculty" data-parent="id_institution">
                            <i class="fas fa-plus"></i> Nuevo
                        </button>
                    </div>
                </div>
                <input type="text" class="form-control dynamic-input" id="new_faculty" placeholder="Nombre de la Facultad">
            </div>

            <!-- Carrera -->
            <div class="form-group">
                <label for="{{ form.career.id_for_label }}">{{ form.career.label }}</label>
                <div class="input-group">
                    {{ form.career }}
                    <div class="input-group-append">
                        <button type="button" class="btn btn-sm btn-outline-secondary dynamic-add-btn" 
                                data-target="career" data-field="id_career">
                            <i class="fas fa-plus"></i> Nuevo
                        </button>
                    </div>
                </div>
                <input type="text" class="form-control dynamic-input" id="new_career" placeholder="Nombre de la Carrera">
            </div>

            <!-- Sede -->
            <div class="form-group">
                <label for="{{ form.campus.id_for_label }}">{{ form.campus.label }}</label>
                <div class="input-group">
                    {{ form.campus }}
                    <div class="input-group-append">
                        <button type="button" class="btn btn-sm btn-outline-secondary dynamic-add-btn" 
                                data-target="campus" data-field="id_campus" data-parent="id_institution">
                            <i class="fas fa-plus"></i> Nuevo
                        </button>
                    </div>
                </div>
                <input type="text" class="form-control dynamic-input" id="new_campus" placeholder="Nombre de la Sede">
            </div>

            <!-- Año -->
            <div class="form-group">
                <label for="{{ form.year.id_for_label }}">{{ form.year.label }}</label>
                {{ form.year }}
            </div>

            <!-- Turno -->
            <div class="form-group">
                <label for="{{ form.shift.id_for_label }}">{{ form.shift.label }}</label>
                {{ form.shift }}
            </div>
        </div>

        <!-- Columna derecha -->
        <div class="form-column">
            <!-- Materia -->
            <div class="form-group">
                <label for="{{ form.subject.id_for_label }}">{{ form.subject.label }}</label>
                <div class="input-group">
                    {{ form.subject }}
                    <div class="input-group-append">
                        <button type="button" class="btn btn-sm btn-outline-secondary dynamic-add-btn" 
                                data-target="subject" data-field="id_subject">
                            <i class="fas fa-plus"></i> Nuevo
                        </button>
                    </div>
                </div>
                <input type="text" class="form-control dynamic-input" id="new_subject" placeholder="Nombre de la Materia">
            </div>

            <!-- Profesor -->
            <div class="form-group">
                <label for="{{ form.professor.id_for_label }}">{{ form.professor.label }}</label>
                {{ form.professor }}
            </div>

            <!-- Tipo de Examen -->
            <div class="form-group">
                <label for="{{ form.exam_type.id_for_label }}">{{ form.exam_type.label }}</label>
                {{ form.exam_type }}
            </div>

            <!-- Número de Parcial -->
            <div class="form-group">
                <label for="{{ form.partial_number.id_for_label }}">{{ form.partial_number.label }}</label>
                {{ form.partial_number }}
            </div>

            <!-- Modalidad -->
            <div class="form-group">
                <label for="{{ form.exam_mode.id_for_label }}">{{ form.exam_mode.label }}</label>
                {{ form.exam_mode }}
            </div>

            <!-- Tiempo de Resolución -->
            <div class="form-group">
                <label for="{{ form.resolution_time.id_for_label }}">{{ form.resolution_time.label }}</label>
                {{ form.resolution_time }}
            </div>

            <!-- Grupo de Examen -->
            <div class="form-group">
                <label for="{{ form.exam_group.id_for_label }}">{{ form.exam_group.label }}</label>
                {{ form.exam_group }}
            </div>
        </div>
    </div>

    <!-- Campos de ancho completo -->
    <div class="full-width-fields">
        <!-- Resultados de Aprendizaje -->
        <div class="form-group">
            <label for="{{ form.learning_outcomes.id_for_label }}">{{ form.learning_outcomes.label }}</label>
            {{ form.learning_outcomes }}
        </div>

        <!-- Notas y Recomendaciones -->
        <div class="form-group">
            <label for="{{ form.notes_and_recommendations.id_for_label }}">{{ form.notes_and_recommendations.label }}</label>
            {{ form.notes_and_recommendations }}
        </div>

        <!-- Temas a Evaluar -->
        <div class="form-group">
            <label for="{{ form.topics_to_evaluate.id_for_label }}">{{ form.topics_to_evaluate.label }}</label>
            {{ form.topics_to_evaluate }}
        </div>

        <!-- Logo de la Institución -->
        <div class="form-group">
            <label for="{{ form.institution_logo.id_for_label }}">{{ form.institution_logo.label }}</label>
            {{ form.institution_logo }}
        </div>

        <!-- Modalidad -->
        <div class="form-group">
            <label for="{{ form.modality.id_for_label }}">{{ form.modality.label }}</label>
            {{ form.modality }}
        </div>
    </div>

    <div class="form-actions">
        <button type="submit" class="btn btn-primary">Guardar Plantilla</button>
        <button type="button" onclick="previewExamTemplate()" class="btn btn-secondary">Previsualizar</button>
    </div>
</form>

<!-- Preview section -->
<div id="preview" class="preview-container">
    <!-- Contenido del preview se genera dinámicamente -->
</div>

<script src="{% static 'material/js/create_exam_template.js' %}"></script>
{% endblock %}