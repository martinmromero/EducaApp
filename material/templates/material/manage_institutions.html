{% extends 'material/base.html' %}
{% load static %}

{% block content %}
<div class="container mt-4">
    <h2>Gestionar Institución</h2>
    <form method="post" enctype="multipart/form-data">
        {% csrf_token %}
        
        <!-- Campos básicos del formulario -->
        <div class="mb-3">
            <label for="id_name" class="form-label">Nombre de la Institución</label>
            {{ form.name }}
        </div>
        
        <div class="mb-3">
            <label for="id_logo" class="form-label">Logo (opcional)</label>
            {{ form.logo }}
        </div>

        <!-- Sección para Sedes (Campus) -->
        <div class="card mt-3">
            <div class="card-header bg-light">
                <h5>Sedes</h5>
            </div>
            <div class="card-body">
                <div id="campuses-container">
                    {% if form.instance.pk %}
                        {% for campus in form.instance.campuses.all %}
                            <div class="mb-2">
                                <input 
                                    type="text" 
                                    name="campuses" 
                                    value="{{ campus.name }}" 
                                    class="form-control" 
                                    placeholder="Nombre de la sede"
                                >
                            </div>
                        {% endfor %}
                    {% endif %}
                    <div class="mb-2">
                        <input 
                            type="text" 
                            name="campuses" 
                            class="form-control" 
                            placeholder="Agregar sede (ej: Sede Central)"
                        >
                    </div>
                </div>
                <button 
                    type="button" 
                    class="btn btn-sm btn-outline-secondary mt-2" 
                    id="add-campus"
                >
                    + Agregar otra sede
                </button>
            </div>
        </div>

        <!-- Sección para Facultades -->
        <div class="card mt-3">
            <div class="card-header bg-light">
                <h5>Facultades</h5>
            </div>
            <div class="card-body">
                <div id="faculties-container">
                    {% if form.instance.pk %}
                        {% for faculty in form.instance.faculties.all %}
                            <div class="mb-2">
                                <input 
                                    type="text" 
                                    name="faculties" 
                                    value="{{ faculty.name }}" 
                                    class="form-control" 
                                    placeholder="Nombre de la facultad"
                                >
                            </div>
                        {% endfor %}
                    {% endif %}
                    <div class="mb-2">
                        <input 
                            type="text" 
                            name="faculties" 
                            class="form-control" 
                            placeholder="Agregar facultad (ej: Ingeniería)"
                        >
                    </div>
                </div>
                <button 
                    type="button" 
                    class="btn btn-sm btn-outline-secondary mt-2" 
                    id="add-faculty"
                >
                    + Agregar otra facultad
                </button>
            </div>
        </div>

        <button type="submit" class="btn btn-primary mt-3">Guardar</button>
    </form>
</div>

<script>
    // Dinámicamente agregar más campos
    document.getElementById('add-campus').addEventListener('click', function() {
        const container = document.getElementById('campuses-container');
        const newInput = document.createElement('div');
        newInput.className = 'mb-2';
        newInput.innerHTML = `
            <input 
                type="text" 
                name="campuses" 
                class="form-control" 
                placeholder="Otra sede"
            >
        `;
        container.appendChild(newInput);
    });

    document.getElementById('add-faculty').addEventListener('click', function() {
        const container = document.getElementById('faculties-container');
        const newInput = document.createElement('div');
        newInput.className = 'mb-2';
        newInput.innerHTML = `
            <input 
                type="text" 
                name="faculties" 
                class="form-control" 
                placeholder="Otra facultad"
            >
        `;
        container.appendChild(newInput);
    });
</script>
{% endblock %}